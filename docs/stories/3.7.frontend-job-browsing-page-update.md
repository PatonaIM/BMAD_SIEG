# Story 3.7: Frontend Job Browsing Page Update

## Status
Ready for Manual Testing

## Story Context

**Existing System Integration:**
- Depends on: Story 3.4 (Job Posting REST API Endpoints - COMPLETED ✅)
- Integrates with: Existing `/jobs/page.tsx` with mock data, Next.js App Router, shadcn/ui components
- Technology: Next.js 14, TypeScript, React 18, TanStack Query (React Query), shadcn/ui, Tailwind CSS
- Follows pattern: Existing frontend architecture (App Router, TypeScript, shadcn/ui components)
- Touch points: Existing job browsing UI, filter components, card layouts

## Story

**As a** candidate,  
**I want** to browse real job postings from the database,  
**so that** I can find positions that match my skills and interests.

## Acceptance Criteria

**Functional Requirements:**

1. `/jobs/page.tsx` updated to fetch data from `GET /api/v1/job-postings` API instead of using mock data
2. Custom hook `useJobPostings` created for data fetching with loading/error/success states
3. Skeleton loaders implemented for initial page load (replaces job cards during loading)
4. Filters (role_category, tech_stack, employment_type, work_setup, experience_level, location) connected to API query params
5. Search functionality (title/company) connected to API search param
6. Pagination implemented when total results exceed limit (20 per page default)
7. Filter changes trigger API refetch with updated query params
8. Search input debounced (500ms delay) to avoid excessive API calls

**UI/UX Requirements:**

9. Existing UI/UX preserved: card layout, badges, icons, spacing, colors all remain unchanged
10. Loading state shows skeleton cards (same dimensions as real cards) to prevent layout shift
11. Empty state displays user-friendly message when no jobs match filters
12. Error state displays retry button and error message when API call fails
13. Results count displays "Showing X jobs" with total from API response

**Quality Requirements:**

14. Code follows Next.js 14 App Router patterns (use client components, server components appropriately)
15. TypeScript strict mode compliance (no `any` types, proper type definitions)
16. Component follows existing pattern from `/dashboard/page.tsx` or `/applications/page.tsx` for API integration
17. Performance: Debounced search, React Query caching prevents unnecessary refetches

## Tasks / Subtasks

- [x] **Task 0: Verify React Query provider setup** (AC: 2, 14)
  - [x] Verify `frontend/app/providers.tsx` exists and contains QueryClientProvider
  - [x] Verify `frontend/src/services/api/queryClient.ts` exists with proper configuration
  - [x] Verify React Query dependencies installed: `@tanstack/react-query` and `@tanstack/react-query-devtools`
  - [x] If QueryClientProvider missing from `frontend/app/providers.tsx`, add it following existing pattern
  - [x] If dependencies missing, install: `cd frontend && pnpm add @tanstack/react-query @tanstack/react-query-devtools`
  - [x] Verify queryClient configuration matches requirements: staleTime=5min, retry=2, refetchOnWindowFocus=false
  - [x] Source: [frontend/app/providers.tsx (existing file)]

- [x] **Task 1: Create API client utility for job postings** (AC: 1, 2, 15)
  - [x] Create or update `frontend/lib/api-client.ts` (if doesn't exist, create it)
  - [x] Define base API URL from environment variable: `const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api/v1'`
  - [x] Create generic fetch wrapper with error handling
  - [x] Create job posting specific API functions
  - [x] Define TypeScript interfaces matching backend schemas
  - [x] Export all functions and types
  - [x] Source: [docs/architecture/frontend/06-api-integration.md#api-client-with-fetch]

- [x] **Task 2: Create useJobPostings custom hook with React Query** (AC: 2, 4, 5, 7, 8, 17)
  - [x] **Prerequisites:** Verify Task 0 completed (React Query provider configured)
  - [x] Create file `frontend/hooks/use-job-postings.ts`
  - [x] Import React Query hooks: `import { useQuery } from '@tanstack/react-query'`
  - [x] Import API client: `import { jobPostingsApi, type JobPostingFilters } from '@/lib/api-client'`
  - [x] Define query key factory
  - [x] Create hook
  - [x] Return type includes: `{ data, isLoading, isError, error, refetch }`
  - [x] Add JSDoc comment explaining hook usage
  - [x] Source: [docs/architecture/frontend/06-api-integration.md#query-hooks-pattern]

- [x] **Task 3: Update /jobs/page.tsx to use API data** (AC: 1, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14)
  - [x] Install debounce utility: `cd frontend && npm add use-debounce`
  - [x] Open `frontend/app/jobs/page.tsx`
  - [x] Add `"use client"` directive at top (required for hooks)
  - [x] Import useJobPostings hook: `import { useJobPostings } from '@/hooks/use-job-postings'`
  - [x] Import debounce hook: `import { useDebouncedCallback } from 'use-debounce'`
  - [x] Import useState, useCallback, useRef from React for filter management
  - [x] Replace mock jobs data with hook call
  - [x] Implement filter update handlers
  - [x] Update filter inputs to call handleFilterChange
  - [x] Implement loading state (show skeleton cards)
  - [x] Implement error state
  - [x] Implement empty state
  - [x] Update results count
  - [x] Keep existing job card mapping, replace `jobs.map` with `data?.jobs.map`
  - [x] Source: [frontend/app/jobs/page.tsx (existing file), docs/architecture/frontend/06-api-integration.md]

- [x] **Task 4: Implement pagination controls** (AC: 6)
  - [x] Add pagination UI at bottom of job list
  - [x] Ensure pagination resets to page 1 when filters change (already handled in Task 3)
  - [x] Source: [shadcn/ui Button component patterns]

- [x] **Task 5: Update filter options to match backend enums** (AC: 4)
  - [x] Open `frontend/app/jobs/page.tsx` filter section
  - [x] Update Select options to match backend field values
  - [x] Ensure Select value prop matches state: `value={filters.employment_type || 'all'}`
  - [x] Ensure "All" option sets filter to empty string
  - [x] Source: [backend/app/models/job_posting.py - Enum definitions]

- [x] **Task 6: Add Skeleton component if missing** (AC: 3, 10)
  - [x] Check if `frontend/components/ui/skeleton.tsx` exists
  - [x] If missing, create it using shadcn/ui pattern
  - [x] Import in jobs/page.tsx: `import { Skeleton } from "@/components/ui/skeleton"`
  - [x] Source: [shadcn/ui Skeleton component documentation]

- [x] **Task 7: Environment variable configuration** (AC: 1, 14)
  - [x] Check if `frontend/.env.local` exists
  - [x] If exists, verify `NEXT_PUBLIC_API_URL` is present (add if missing)
  - [x] If doesn't exist, create `frontend/.env.local`
  - [x] Check if `frontend/.env.example` exists
  - [x] Update or create `frontend/.env.example` with variable documentation
  - [x] Verify `.env.local` is in `.gitignore` (add if missing)
  - [x] Source: [docs/architecture/frontend/10-environment-configuration.md]

- [x] **Task 8: Type safety and linting** (AC: 15)
  - [x] Run TypeScript compiler: `cd frontend && npm tsc --noEmit`
  - [x] Fix any type errors
  - [x] Run linter: `cd frontend && npm lint`
  - [x] Fix any linting warnings
  - [x] Ensure no `any` types used (prefer `unknown` if type truly unknown)
  - [x] Source: [docs/architecture/frontend/11-frontend-developer-standards.md]

- [ ] **Task 9: Manual testing** (AC: 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13)
  - [ ] Start backend server: `cd backend && uvicorn main:app --reload`
  - [ ] Ensure seed data exists: Run `uv run python backend/scripts/seed_job_postings.py` if needed
  - [ ] Start frontend dev server: `cd frontend && pnpm dev`
  - [ ] Navigate to http://localhost:3000/jobs
  - [ ] **Test initial load:**
    - [ ] Verify skeleton loaders appear briefly during loading
    - [ ] Verify real job cards appear after load completes
    - [ ] Verify "Showing X of Y jobs" count is accurate
  - [ ] **Test search functionality:**
    - [ ] Type "developer" in search box
    - [ ] Wait 500ms (debounce)
    - [ ] Verify API call made (check Network tab)
    - [ ] Verify results filtered by search term
  - [ ] **Test filters:**
    - [ ] Select "Full-time" from Job Type dropdown
    - [ ] Verify API refetch with `employment_type=full_time` query param
    - [ ] Verify results update immediately
    - [ ] Test other filters: location, experience level, work setup
    - [ ] Test combined filters
  - [ ] **Test pagination:**
    - [ ] If total > 20 jobs, verify pagination controls appear
    - [ ] Click "Next" button
    - [ ] Verify `skip=20` in API query
    - [ ] Verify new page of results loads
    - [ ] Click "Previous" to go back
  - [ ] **Test empty state:**
    - [ ] Enter nonsense search term: "zzzzzzzzzz"
    - [ ] Verify "No Jobs Found" message appears
    - [ ] Click "Clear Filters" button
    - [ ] Verify filters reset and all jobs shown
  - [ ] **Test error handling:**
    - [ ] Stop backend server
    - [ ] Reload page or trigger refetch
    - [ ] Verify error message appears
    - [ ] Click "Retry" button
    - [ ] Restart backend
    - [ ] Verify retry succeeds after backend starts
  - [ ] **Test UI preservation:**
    - [ ] Compare old mock data UI with new API-driven UI
    - [ ] Verify card layout identical (spacing, borders, shadows)
    - [ ] Verify badges same style and color
    - [ ] Verify icons same size and position
    - [ ] Verify responsive behavior on mobile (resize browser)

## Dev Notes

### Previous Story Insights

**From Story 3.4: Job Posting REST API Endpoints (COMPLETED ✅)**

- **API Endpoints Created:**
  - `GET /api/v1/job-postings` - List with filters (role_category, tech_stack, employment_type, work_setup, experience_level, location, search, skip, limit)
  - `GET /api/v1/job-postings/{id}` - Single job detail
- **Response Schemas:**
  - `JobPostingListResponse`: { jobs: [], total: int, skip: int, limit: int }
  - `JobPostingResponse`: Full job posting fields (id, title, company, description, role_category, tech_stack, employment_type, work_setup, experience_level, location, salary_range_min, salary_range_max, required_skills, preferred_skills, benefits, posted_at, closing_at, status)
- **No Authentication Required:** Public job browsing
- **CORS Configured:** Frontend (http://localhost:3000) can access API
- **Pagination:** Default limit=20, max limit=100, skip for offset
- **Search:** Case-insensitive partial match on title and company
- **Filter Validation:** All filter params optional, invalid values ignored

**From Existing Frontend Codebase:**

- **Current `/jobs/page.tsx` Implementation:**
  - Uses mock data array (5 hardcoded jobs)
  - Filters are UI-only (don't actually filter mock data)
  - Search input exists but not functional
  - No pagination (only 5 mock jobs)
  - Uses shadcn/ui components: Card, Button, Input, Select, Badge
  - Client component with useState for filter state
- **Existing Component Patterns:**
  - Uses shadcn/ui components from `@/components/ui/`
  - Follows Next.js 14 App Router conventions
  - Uses Tailwind CSS for styling
  - Lucide React for icons (Search, MapPin, DollarSign, etc.)
- **Existing Filter Structure:**
  - searchQuery, location, jobType (select), experience (select)
  - No role_category, tech_stack, employment_type, work_setup filters yet
- **Card Layout:**
  - Header: Job title, company, "View Details" button, Featured badge (conditional)
  - Content: Location, job type, salary, posted date icons
  - Skills badges (tech stack)
  - Footer: Applicant count, experience level badge

### Technical Architecture Context

**Frontend Tech Stack** [Source: docs/architecture/frontend/02-frontend-tech-stack.md]
- **Framework:** Next.js 14 (App Router, React 18, TypeScript 5)
- **State Management:** React Query (TanStack Query) for server state, React hooks for local state
- **UI Components:** shadcn/ui (Radix UI primitives + Tailwind CSS)
- **Styling:** Tailwind CSS utility classes
- **HTTP Client:** Native `fetch` API (no axios)
- **Form Handling:** React Hook Form (not needed for this story)

**API Integration Pattern** [Source: docs/architecture/frontend/06-api-integration.md]
- **Pattern:** React Query for data fetching, custom hooks wrapping useQuery/useMutation
- **Query Keys:** Factory pattern for cache invalidation (`jobPostingsKeys.list(filters)`)
- **Caching Strategy:** staleTime=5min, gcTime=30min, retry=2
- **Error Handling:** React Query error states, user-friendly error messages
- **Loading States:** React Query isLoading, skeleton loaders prevent layout shift

**Component Standards** [Source: docs/architecture/frontend/04-component-standards.md]
- **File Naming:** PascalCase for components (but page.tsx is exception)
- **Exports:** Named exports preferred, default export for pages
- **Props:** Explicit TypeScript interfaces, prefix booleans with is/has/should
- **Hooks:** Custom hooks use camelCase with `use` prefix (useJobPostings)
- **Client Components:** Require `"use client"` directive when using hooks/state

**State Management** [Source: docs/architecture/frontend/05-state-management.md]
- **Server State:** React Query (queries, mutations, cache)
- **Client State:** React useState, useReducer for local component state
- **Form State:** React Hook Form (not applicable here)
- **URL State:** Next.js router query params for shareable filter state (future enhancement)

**Styling Guidelines** [Source: docs/architecture/frontend/08-styling-guidelines.md]
- **Utility-First:** Tailwind CSS classes directly in JSX
- **Component Variants:** Use `cn()` utility to merge class names conditionally
- **Responsive:** Mobile-first breakpoints (sm:, md:, lg:, xl:)
- **Theme:** CSS variables for colors, defined in globals.css
- **Spacing:** Consistent spacing using Tailwind scale (space-y-4, gap-2, p-6)

**Performance Optimization** [Source: docs/architecture/frontend/13-performance-optimization.md]
- **React Query Caching:** Reduces redundant API calls
- **Debounced Search:** 500ms delay prevents API call on every keystroke
- **Skeleton Loaders:** Prevent layout shift, improve perceived performance
- **Pagination:** Load only 20 jobs at a time, infinite scroll future enhancement
- **Memoization:** Use useMemo for expensive computations (not needed here)

**Error Handling** [Source: docs/architecture/frontend/16-error-handling-recovery.md]
- **User-Friendly Messages:** Avoid technical jargon in error displays
- **Retry Mechanism:** Provide "Retry" button for failed API calls
- **Graceful Degradation:** Show partial data if available, clear error boundaries
- **Network Errors:** Check navigator.onLine, show offline message
- **Validation Errors:** Display field-level errors (not applicable for this story)

### File Locations and Structure

[Source: docs/architecture/frontend/03-project-structure.md]

**Important: Frontend Structure Pattern**

This project uses Next.js 14 App Router structure (`app/`, `lib/`, `hooks/`, `components/`). You may see legacy `src/` directories (e.g., `frontend/src/services/api/queryClient.ts`) from a previous Vite migration - these remain for backward compatibility but are not the pattern for new code. **All new code in this story follows the Next.js App Router pattern:**
- New API clients: `frontend/lib/`
- New custom hooks: `frontend/hooks/`
- New pages: `frontend/app/`
- UI components: `frontend/components/ui/`

**Files to Create:**
- `frontend/lib/api-client.ts` - API client with fetch wrapper and job postings API functions
- `frontend/hooks/use-job-postings.ts` - Custom React Query hook for job postings
- `frontend/components/ui/skeleton.tsx` - Skeleton component (if not exists)
- `frontend/.env.local` - Environment variables for API URL (if not exists)

**Files to Update:**
- `frontend/app/jobs/page.tsx` - Replace mock data with API integration
- `frontend/.env.example` - Document NEXT_PUBLIC_API_URL variable

**Files to Verify (Already Exist):**
- `frontend/app/providers.tsx` - React Query provider wrapper (already configured)
- `frontend/src/services/api/queryClient.ts` - Query client instance (legacy location, already exists)
- `frontend/app/layout.tsx` - Root layout with Providers wrapper (already configured)

**Files Referenced (Read-Only):**
- `frontend/components/ui/card.tsx` - Existing Card component
- `frontend/components/ui/button.tsx` - Existing Button component
- `frontend/components/ui/input.tsx` - Existing Input component
- `frontend/components/ui/select.tsx` - Existing Select component
- `frontend/components/ui/badge.tsx` - Existing Badge component
- `frontend/lib/utils.ts` - Existing cn() utility function

### TypeScript Type Definitions

**JobPosting Interface** (matches backend JobPostingResponse schema):
```typescript
export interface JobPosting {
  id: string; // UUID as string
  title: string;
  company: string;
  description: string;
  role_category: string; // engineering, product, design, sales, etc.
  tech_stack: string | null; // Technical stack (react, python, etc.) or null for non-tech
  employment_type: string; // full_time, part_time, contract, internship
  work_setup: string; // remote, hybrid, onsite
  experience_level: string; // entry, junior, mid, senior, lead, principal
  location: string;
  salary_range_min: number | null;
  salary_range_max: number | null;
  required_skills: string[] | null; // JSONB array from backend
  preferred_skills: string[] | null;
  benefits: string[] | null;
  posted_at: string; // ISO 8601 datetime string
  closing_at: string | null;
  status: string; // draft, active, closed, filled
}
```

**Filter State Interface:**
```typescript
interface JobPostingFilters {
  search?: string; // Searches title and company
  location?: string;
  role_category?: string;
  tech_stack?: string;
  employment_type?: string;
  work_setup?: string;
  experience_level?: string;
  skip?: number; // Pagination offset (default 0)
  limit?: number; // Results per page (default 20)
}
```

**API Response Interface:**
```typescript
interface JobPostingListResponse {
  jobs: JobPosting[];
  total: number; // Total count matching filters (for pagination)
  skip: number; // Current offset
  limit: number; // Current page size
}
```

### Mapping Mock Data to Real API Data

**Mock Data Field → API Field Mapping:**
- `id` → `id` (same)
- `title` → `title` (same)
- `company` → `company` (same)
- `location` → `location` (same)
- `type` → `employment_type` (rename, values: full-time → full_time)
- `salary` → `salary_range_min` + `salary_range_max` (format as "$XXk - $YYk")
- `experience` → `experience_level` (rename, values match but lowercase)
- `skills` → `required_skills` (tech_stack or required_skills array)
- `postedAt` → `posted_at` (format: "2 days ago" from ISO datetime)
- `applicants` → **Not in API** (remove or hardcode to 0 for now)
- `featured` → **Not in API** (set to false or use status === "active" && is_featured flag if added)

**Date Formatting:**
```typescript
// Convert posted_at ISO string to relative time
function formatPostedDate(postedAt: string): string {
  const date = new Date(postedAt);
  const now = new Date();
  const diffMs = now.getTime() - date.getTime();
  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
  
  if (diffDays === 0) return 'Today';
  if (diffDays === 1) return '1 day ago';
  if (diffDays < 7) return `${diffDays} days ago`;
  if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
  return `${Math.floor(diffDays / 30)} months ago`;
}
```

**Salary Formatting:**
```typescript
function formatSalaryRange(min: number | null, max: number | null): string {
  if (!min && !max) return 'Salary not specified';
  if (!max) return `$${Math.round(min! / 1000)}k+`;
  if (!min) return `Up to $${Math.round(max / 1000)}k`;
  return `$${Math.round(min / 1000)}k - $${Math.round(max / 1000)}k`;
}
```

### Testing Strategy

[Source: docs/architecture/frontend/09-testing-requirements.md]

**Testing Standards for This Story:**

Manual testing approach is required (no automated tests for this story). The testing strategy focuses on:
- Framework: Manual browser-based testing
- Test execution: Local development environment (backend + frontend running)
- Coverage areas: Visual regression, functional correctness, error handling, performance, responsive design
- Test data: Seed data from `backend/scripts/seed_job_postings.py`
- Validation: All acceptance criteria verified through manual test cases (TC1-TC10)

**Manual Testing Focus:**
This story uses manual testing approach (no automated tests required). Focus on:
1. **Visual Regression:** Ensure UI looks identical to mock data version
2. **Functional Testing:** All filters, search, pagination work correctly
3. **Error Scenarios:** Network failures, empty results handled gracefully
4. **Performance:** No visible lag, smooth transitions, debounced search works
5. **Responsive Design:** Test on mobile viewport (375px width minimum)

**Future Automated Tests (Not Required for This Story):**
- Unit tests for `useJobPostings` hook (mock React Query)
- Integration tests for filter/pagination logic
- E2E tests with Playwright for critical user flows

### Known Edge Cases and Constraints

1. **Empty Results on First Load:**
   - If no job postings exist in database, empty state will show
   - Solution: Ensure seed script runs before testing frontend
   
2. **Slow API Responses:**
   - Skeleton loaders prevent layout shift
   - React Query retry (2 attempts) handles transient failures
   
3. **Filter Reset Behavior:**
   - Changing any filter resets pagination to page 1
   - "Clear Filters" button resets all filters to defaults
   
4. **Search Debounce:**
   - 500ms delay means user must stop typing before search triggers
   - Clear visual feedback: show loading state during debounce
   
5. **Tech Stack vs Role Category:**
   - Non-technical roles have null tech_stack
   - Use required_skills array as fallback for skill badges
   
6. **Salary Range Display:**
   - Some jobs may have null min/max
   - Format as "Salary not specified" or "Negotiable"
   
7. **Applicant Count Not Available:**
   - Mock data had applicant count, API doesn't
   - Options: Remove field, show "N/A", or mock as 0 for now

### Integration Verification Checklist

**IV1: Existing Navigation** - Verify navigation to/from jobs page works unchanged
- [ ] Click "Browse Jobs" from home page → navigates to /jobs
- [ ] Click "AI Matches" button → navigates to /jobs/matches
- [ ] Click "View Details" on job card → navigates to /jobs/[id]
- [ ] Browser back button returns to previous page correctly

**IV2: Filter State Management** - Confirm filter changes don't break other page functionality
- [ ] Filters persist when navigating to job detail and back (future: URL query params)
- [ ] No console errors when rapidly changing filters
- [ ] React Query cache invalidates correctly on filter change

**IV3: Visual Consistency** - Verify API-driven job cards look identical to previous mock data cards
- [ ] Card dimensions, spacing, padding identical
- [ ] Badge colors and styles match
- [ ] Icon sizes and positions match
- [ ] Typography (font size, weight, color) matches
- [ ] Hover effects and shadows match

## Testing

### Manual Testing Checklist

**Test Environment Setup:**
1. Ensure backend running with seed data: `cd backend && uvicorn main:app --reload`
2. Verify seed data exists: `uv run python backend/scripts/seed_job_postings.py`
3. Start frontend dev server: `cd frontend && pnpm dev`
4. Open browser to http://localhost:3000/jobs

**Test Cases:**

**TC1: Initial Page Load**
- [ ] Navigate to /jobs page
- [ ] Verify skeleton loaders appear during initial load
- [ ] Verify job cards appear after data loads
- [ ] Verify "Showing X of Y jobs" count displays correctly
- [ ] Verify no console errors

**TC2: Search Functionality**
- [ ] Type "developer" in search box
- [ ] Verify no API call immediately (debounce 500ms)
- [ ] Wait 500ms, verify API call in Network tab with `?search=developer`
- [ ] Verify results filtered to match search term
- [ ] Clear search, verify all jobs return
- [ ] Type rapidly "abc123xyz", verify only one API call after 500ms

**TC3: Filter Functionality**
- [ ] Select "Full-time" from Job Type dropdown
- [ ] Verify API refetch with `?employment_type=full_time`
- [ ] Verify results update to show only full-time jobs
- [ ] Select "Remote" from Work Setup dropdown
- [ ] Verify API refetch with `?employment_type=full_time&work_setup=remote`
- [ ] Verify results show only full-time remote jobs
- [ ] Test other filters: experience level, role category, location
- [ ] Click "Clear Filters" button, verify all filters reset and all jobs shown

**TC4: Pagination**
- [ ] If total jobs > 20, verify pagination controls appear at bottom
- [ ] Verify "Previous" button disabled on page 1
- [ ] Click "Next" button
- [ ] Verify `?skip=20` in API query
- [ ] Verify page 2 of results loads
- [ ] Verify page number updates: "Page 2 of N"
- [ ] Click "Previous" button, verify return to page 1
- [ ] Verify "Next" button disabled on last page

**TC5: Empty State**
- [ ] Enter nonsense search: "zzzzzzzzzz123"
- [ ] Verify "No Jobs Found" card displays
- [ ] Verify message: "Try adjusting your filters..."
- [ ] Click "Clear Filters" button
- [ ] Verify filters reset and all jobs shown

**TC6: Error Handling**
- [ ] Stop backend server
- [ ] Reload /jobs page or trigger refetch
- [ ] Verify error message displays: "Error Loading Jobs"
- [ ] Verify error card shows message
- [ ] Click "Retry" button
- [ ] Restart backend server
- [ ] Verify retry succeeds and jobs load

**TC7: Visual Regression**
- [ ] Compare side-by-side: old mock UI vs new API UI
- [ ] Verify card layout identical (spacing, borders, shadows, padding)
- [ ] Verify badge styles match (colors, sizes, rounded corners)
- [ ] Verify icon sizes and positions match
- [ ] Verify button styles match
- [ ] Verify typography identical (font sizes, weights, colors)

**TC8: Responsive Design**
- [ ] Resize browser to 375px width (mobile)
- [ ] Verify layout stacks vertically on mobile
- [ ] Verify filters remain accessible (no horizontal scroll)
- [ ] Verify job cards readable on mobile
- [ ] Verify pagination controls work on mobile
- [ ] Resize to desktop, verify layout expands correctly

**TC9: Performance**
- [ ] Measure initial load time (should be < 2 seconds with local backend)
- [ ] Verify no unnecessary API calls (check Network tab)
- [ ] Change filters rapidly, verify only final filter state triggers API call
- [ ] Type in search rapidly, verify only one API call after debounce
- [ ] Verify smooth transitions (no janky animations or layout shifts)

**TC10: React Query DevTools**
- [ ] Open React Query DevTools (bottom left corner)
- [ ] Verify query key structure: `['job-postings', 'list', { ...filters }]`
- [ ] Change filters, verify new query created with new key
- [ ] Verify cached queries show "stale" after 5 minutes
- [ ] Manually refetch in DevTools, verify API call made

## Dev Agent Record

### Agent Model Used
Claude 3.5 Sonnet (2024)

### Debug Log References
No debug logs required - implementation completed without blocking issues.

### Completion Notes List
1. **Task 0-2 completed**: React Query provider verified, API client created with fetch wrapper, custom useJobPostings hook implemented
2. **Task 3-5 completed**: Jobs page fully refactored to use API data with debounced search, all filters connected to backend enums
3. **Task 6-8 completed**: Skeleton component verified, environment variables confirmed, TypeScript compilation successful with no errors in new code
4. **Helper functions added**: formatPostedDate() and formatSalaryRange() to transform API data for display
5. **All states implemented**: Loading (skeleton cards), error (with retry), empty (with clear filters), and success states
6. **Pagination implemented**: Previous/Next buttons with page counter, resets to page 1 on filter changes
7. **Type safety**: All TypeScript types properly defined, no `any` types used, strict mode compliance

### File List
**Created:**
- `frontend/lib/api-client.ts` - API client with fetch wrapper and job postings endpoints
- `frontend/hooks/use-job-postings.ts` - Custom React Query hook for data fetching

**Modified:**
- `frontend/app/jobs/page.tsx` - Complete refactor: removed mock data, added API integration, loading/error/empty states, pagination

**Verified (No Changes):**
- `frontend/app/providers.tsx` - React Query provider already configured
- `frontend/src/services/api/queryClient.ts` - Query client configuration already exists
- `frontend/components/ui/skeleton.tsx` - Skeleton component already exists
- `frontend/.env.local` - Environment variables already configured
- `frontend/.env.example` - Environment variables already documented

**Dependencies Added:**
- `use-debounce` - npm package for search input debouncing (500ms delay)

## QA Results
_To be filled by QA agent after implementation review and testing_

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-05 | 1.0 | Initial story draft created for frontend job browsing page update | SM Agent (Bob) |
| 2025-11-05 | 1.1 | Validation fixes: Added Task 0 (React Query verification), updated Task 3 to use use-debounce package, updated Task 7 (env vars check existing), renumbered tasks, added frontend structure clarification note, added Testing subsection to Dev Notes, added Dev Agent Record and QA Results sections | PO Agent (Sarah) |

---

**Epic:** Epic 03: Job-Driven AI Interview Flow  
**Dependencies:** Story 3.4 (Job Posting REST API Endpoints - COMPLETED ✅)  
**Blocks:** None (frontend stories can proceed independently)

---
